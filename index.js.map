{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst apiParams = {\n    key: \"48326966-0a5fa166f497e375098be0f90\",\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: 15\n};\n\nexport const searchImages = (query, pageNumber) => {\n    return axios.get(\"https://pixabay.com/api/\", {\n        params: {\n            ...apiParams,\n            q: query,\n            page: pageNumber\n        }\n    });\n};\n\nexport default searchImages;","export const renderGallery = data => {\n    return data.hits.map(img => {\n        return `<li class='gallery-item'>\n            <a href='${img.largeImageURL}'><img class='gallery-img' src='${img.webformatURL}' alt='${img.tags}'></a>\n            <ul class='user-activity'>\n                <li class='user-activity-item'><span class='user-activity-header'>Likes</span>${img.likes}</li>\n                <li class='user-activity-item'><span class='user-activity-header'>Views</span>${img.views}</li>\n                <li class='user-activity-item'><span class='user-activity-header'>Comments</span>${img.comments}</li>\n                <li class='user-activity-item'><span class='user-activity-header'>Downloads</span>${img.downloads}</li>\n            </ul>\n        </li>`;\n    });\n};\n\nexport default renderGallery;","import searchImages from \"./js/pixabay-api\";\nimport renderGallery from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport SimpleLightbox from \"simplelightbox\";\n\nconst searchForm = document.querySelector(\".search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMore = document.querySelector(\".load-more\");\n\nconst lightbox = new SimpleLightbox(\".gallery a\", { captionsData: \"alt\" });\n\nconst errMsg = msg => {\n    iziToast.error({\n        title: \"\",\n        message: msg,\n        position: \"topRight\"\n    });\n};\n\nconst currentQuery = {\n    query: \"\",\n    page: 1,\n    totalHits: 0\n};\n\nconst formSubmitHandler = async event => {\n    event.preventDefault();\n    const query = searchForm.query.value;\n    currentQuery.query = query;\n    currentQuery.page = 1;\n    gallery.innerHTML = \"\";\n    loader.classList.remove(\"el-hidden\");\n    loadMore.classList.add(\"el-hidden\");\n    try {\n        if (query == \"\")\n        {\n            throw new Error(\"Search query input cannot be empty.\");\n        }\n        const queryResult = await searchImages(query, 1);\n        const galleryItems = renderGallery(queryResult.data);\n        currentQuery.totalHits = queryResult.data.totalHits;\n        if (galleryItems.length > 0) {\n            gallery.innerHTML = galleryItems.join('');\n            lightbox.refresh();\n            if (currentQuery.totalHits > 15)\n            {\n                loadMore.classList.remove(\"el-hidden\");\n            }\n        }\n        else {\n            throw new Error(\"Sorry, there are no images matching your search query. Please try again!\");\n        }\n    }\n    catch (err)\n    {\n        errMsg(err.message);\n    }\n    finally\n    {\n        loader.classList.add(\"el-hidden\");\n    }\n};\n\nconst loadMoreClickHandler = async event => {\n    try\n    {\n        loadMore.classList.add(\"el-hidden\");\n        loader.classList.remove(\"el-hidden\");\n        const queryResult = await searchImages(currentQuery.query, ++currentQuery.page);\n        const galleryItems = renderGallery(queryResult.data);\n        if (galleryItems.length > 0)\n        {\n            const scrollHeight = gallery.lastChild.getBoundingClientRect().height * 2;\n            gallery.insertAdjacentHTML(\"beforeend\", galleryItems.join(''));\n            window.scrollBy({\n                top: scrollHeight,\n                left: 0,\n                behavior: \"smooth\"\n            });\n            lightbox.refresh();\n            if (galleryItems.length < 15)\n            {\n                errMsg(\"We're sorry, but you've reached the end of search results.\");\n            }\n            else\n            {\n                loadMore.classList.remove(\"el-hidden\");\n            }\n        }\n        else\n        {\n            throw new Error(\"We're sorry, but you've reached the end of search results.\");\n        }\n    }\n    catch (err)\n    {\n        errMsg(err.message);\n    }\n    finally\n    {\n        loader.classList.add(\"el-hidden\");\n    }\n};\n\nsearchForm.addEventListener(\"submit\", formSubmitHandler);\nloadMore.addEventListener(\"click\", loadMoreClickHandler);"],"names":["apiParams","searchImages","query","pageNumber","axios","renderGallery","data","img","searchForm","gallery","loader","loadMore","lightbox","SimpleLightbox","errMsg","msg","iziToast","currentQuery","formSubmitHandler","event","queryResult","galleryItems","err","loadMoreClickHandler","scrollHeight"],"mappings":"owBAEA,MAAMA,EAAY,CACd,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,EACd,EAEaC,EAAe,CAACC,EAAOC,IACzBC,EAAM,IAAI,2BAA4B,CACzC,OAAQ,CACJ,GAAGJ,EACH,EAAGE,EACH,KAAMC,CACT,CACT,CAAK,ECjBQE,EAAgBC,GAClBA,EAAK,KAAK,IAAIC,GACV;AAAA,uBACQA,EAAI,aAAa,mCAAmCA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA,gGAEbA,EAAI,KAAK;AAAA,gGACTA,EAAI,KAAK;AAAA,mGACNA,EAAI,QAAQ;AAAA,oGACXA,EAAI,SAAS;AAAA;AAAA,cAG5G,ECNCC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAW,SAAS,cAAc,YAAY,EAE9CC,EAAW,IAAIC,EAAe,aAAc,CAAE,aAAc,KAAK,CAAE,EAEnEC,EAASC,GAAO,CAClBC,EAAS,MAAM,CACX,MAAO,GACP,QAASD,EACT,SAAU,UAClB,CAAK,CACL,EAEME,EAAe,CACjB,MAAO,GACP,KAAM,EACN,UAAW,CACf,EAEMC,EAAoB,MAAMC,GAAS,CACrCA,EAAM,eAAc,EACpB,MAAMjB,EAAQM,EAAW,MAAM,MAC/BS,EAAa,MAAQf,EACrBe,EAAa,KAAO,EACpBR,EAAQ,UAAY,GACpBC,EAAO,UAAU,OAAO,WAAW,EACnCC,EAAS,UAAU,IAAI,WAAW,EAClC,GAAI,CACA,GAAIT,GAAS,GAET,MAAM,IAAI,MAAM,qCAAqC,EAEzD,MAAMkB,EAAc,MAAMnB,EAAaC,EAAO,CAAC,EACzCmB,EAAehB,EAAce,EAAY,IAAI,EAEnD,GADAH,EAAa,UAAYG,EAAY,KAAK,UACtCC,EAAa,OAAS,EACtBZ,EAAQ,UAAYY,EAAa,KAAK,EAAE,EACxCT,EAAS,QAAO,EACZK,EAAa,UAAY,IAEzBN,EAAS,UAAU,OAAO,WAAW,MAIzC,OAAM,IAAI,MAAM,0EAA0E,CAEjG,OACMW,EACP,CACIR,EAAOQ,EAAI,OAAO,CACrB,QACL,CAEQZ,EAAO,UAAU,IAAI,WAAW,CACnC,CACL,EAEMa,EAAuB,MAAMJ,GAAS,CACxC,GACA,CACIR,EAAS,UAAU,IAAI,WAAW,EAClCD,EAAO,UAAU,OAAO,WAAW,EACnC,MAAMU,EAAc,MAAMnB,EAAagB,EAAa,MAAO,EAAEA,EAAa,IAAI,EACxEI,EAAehB,EAAce,EAAY,IAAI,EACnD,GAAIC,EAAa,OAAS,EAC1B,CACI,MAAMG,EAAef,EAAQ,UAAU,sBAAuB,EAAC,OAAS,EACxEA,EAAQ,mBAAmB,YAAaY,EAAa,KAAK,EAAE,CAAC,EAC7D,OAAO,SAAS,CACZ,IAAKG,EACL,KAAM,EACN,SAAU,QAC1B,CAAa,EACDZ,EAAS,QAAO,EACZS,EAAa,OAAS,GAEtBP,EAAO,4DAA4D,EAInEH,EAAS,UAAU,OAAO,WAAW,CAE5C,KAGG,OAAM,IAAI,MAAM,4DAA4D,CAEnF,OACMW,EACP,CACIR,EAAOQ,EAAI,OAAO,CACrB,QACL,CAEQZ,EAAO,UAAU,IAAI,WAAW,CACnC,CACL,EAEAF,EAAW,iBAAiB,SAAUU,CAAiB,EACvDP,EAAS,iBAAiB,QAASY,CAAoB"}